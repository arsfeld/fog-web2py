/* Copyright (c) 2007 Kean Loong Tan http://www.gimiti.com/kltan
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * Version: 1.0 (March 12, 2008)
 * Requires: jQuery 1.2+
 */
var dialogDisplayed=0;jQuery.fn.createDialog=function(D,A,C,B){if(C==undefined){C="GET"}if(B==undefined){B=""}if(A==undefined){A=true}if($("#jDialogProgressBar").size()==0&&!($.browser.msie&&parseInt($.browser.version)<7)){$("body").prepend('<div id="jDialogProgressBar"><img src="i/ajax-loader.gif" /></div>')}$(this).click(function(){if(dialogDisplayed!=1){$("#jDialogProgressBar").show();$.blockOverlay(1);dialogDisplayed=1;$.ajax({type:C,data:B,url:D,success:function(E){$("#jDialogContainer").html(E);$.reposition();$("#jDialogProgressBar").fadeOut(1500)}})}else{if(A){$("#jDialogProgressBar").show()}$.ajax({type:"GET",url:D,success:function(E){$("#jDialogContainer").html(E);$.reposition();$("#jDialogProgressBar").fadeOut(1500)}})}if($.browser.msie&&parseInt($.browser.version)<7){$(window).scroll(function(){if(dialogDisplayed==1){$.blockOverlay();$.reposition()}})}$(window).resize(function(){if(dialogDisplayed==1){$.blockOverlay();$.reposition()}});$(window).unload(function(){if(dialogDisplayed==1){$.closeDialog()}});$(window).keydown(function(E){if(E.keyCode==27){$.closeDialog()}})})};jQuery.closeDialog=function(){dialogDisplayed=0;$("select").show();$("#jDialogContainer, #jDialogOverlay").remove()};jQuery.blockOverlay=function(F){if(F==1){$("body").append('<div id="jDialogOverlay"></div><div id="jDialogContainer"></div>')}var E=0;var D=0;var C=$(window).width();var G=$(document).height();var B=$(window).width();var A=$(window).height();if($.browser.msie&&parseInt($.browser.version)<7){$("#jDialogOverlay").css({top:0,left:0,width:C,height:G,position:"absolute",display:"block"})}else{$("#jDialogOverlay").css({top:0,left:0,width:B,height:A,position:"fixed",display:"block"}).show()}if(F==1){$("#jDialogOverlay").css("opacity",0);$("#jDialogOverlay").show().fadeTo(200,0.85)}};jQuery.reposition=function(){var A=0;var F=0;var B=$(window).width();var C=$(window).height();var G=$("#jDialogContainer").children().height();var D=$("#jDialogContainer").children().width();if($.browser.msie){A=document.body.scrollLeft||document.documentElement.scrollLeft;F=document.body.scrollTop||document.documentElement.scrollTop}else{A=window.pageXOffset;F=window.pageYOffset}var J=F+C/2-G/2;var H=A+B/2-D/2;var I=J-F;var E=H-A;if($.browser.msie&&parseInt($.browser.version)<7){$("select").hide();$("#jDialogContainer select").show();$("#jDialogContainer").children().css({top:J,left:H,position:"absolute"}).show()}else{$("#jDialogContainer").children().css({top:I,left:E,position:"fixed"}).show()}};